<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">  
    <title>Surat Perjanjian Kerja Sama Jasa</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../inc/css/bootstrap-manual.css">

    <style>
        body {
        font-family: "Times New Roman", serif;
        margin: 50px;
        line-height: 1.6;
        }
        h2, h3 {
        text-align: center;
        margin: 0;
        }
        .pasal {
        margin-top: 20px;
        font-weight: bold;
        }
        .indent {
        margin-left: 20px;
        }
        .ttd {
        margin-top: 50px;
        display: flex;
        justify-content: space-between;
        }
        .ttd div {
        width: 100%;
        text-align: center;
        }
        .signature-space {
        margin-top: 60px;
        }
    </style>
</head>
<body>

    <div id="cetakIni" style="font-family: 'Times New Roman', Times, serif;">

        <h3 style="text-align:center;">SURAT PERJANJIAN KERJA SAMA JASA</h3>
        <h4 style="text-align:center;" id="noSurat">Nomor: [Nomor Surat, jika ada]</h4>

        <p style="margin-top:2rem;">Pada hari <strong id="hariIni">[hari]</strong>, <strong id="tglIni">[tanggal lengkap]</strong>, kami yang bertanda tangan di bawah ini:</p>

        <table style="width:100%;">
            <tr>
                <td style="width:50%;">Nama :</td>
                <td>Kahfi Setiawan</td>
            </tr>
            <tr>
                <td>Alamat :</td>
                <td>Dusun Canukur</td>
            </tr>
            <tr>
                <td>Nomor KTP :</td>
                <td>331xxxxxxxxxxxxx</td>
            </tr>
            <tr>
                <td>Selanjutnya disebut sebagai <strong>PIHAK PERTAMA</strong></td>
            </tr>
        </table>
        <br>
        <table style="width:100%;">
            <tr>
                <td style="width:50%;">Nama :</td>
                <td id="nama"></td>
            </tr>
            <tr>
                <td>Alamat :</td>
                <td id="alamat">[Alamat Penerima Jasa]</td>
            </tr>
            <tr>
                <td>Nomor KTP :</td>
                <td id="ktp">[Nomor KTP Penerima Jasa]</td>
            </tr>
            <tr>
                <td>Selanjutnya disebut sebagai <strong>PIHAK KEDUA</strong></td>
            </tr>
        </table>

        <br>

        <p>Kedua belah pihak sepakat untuk mengadakan perjanjian kerja sama jasa dengan ketentuan sebagai berikut:</p>

        <div class="pasal">PASAL 1 - LINGKUP PEKERJAAN</div>
        <p class="indent">PIHAK PERTAMA bersedia memberikan layanan jasa berupa: <br>
        <em id="detail">[Deskripsikan layanan secara jelas, misal: Perbaikan instalasi listrik rumah tangga, dll]</em></p>

        <div class="pasal">PASAL 2 - JANGKA WAKTU</div>
        <p class="indent">Perjanjian ini berlaku sejak tanggal <strong id="startDate">[tanggal mulai]</strong> sampai dengan <strong id="endDate">[tanggal selesai]</strong>. Sesuai kesepakatan kedua belah pihak.</p>

        <div class="pasal">PASAL 3 - PEMBAYARAN</div>
        <ol class="indent">
        <li><strong>PIHAK KEDUA</strong> wajib membayar kepada <strong>PIHAK PERTAMA</strong> sebesar <strong>50%</strong> dari <strong id="total">Rp [jumlah nominal]</strong> atau sebesar <strong id="halfTotal"></strong> sebagai uang muka sebelum mulai pengerjaan.</li>
        <li>Pembayaran sisanya <strong>(50%)</strong> lagi, dilakukan secara:
            <ul>
            <li>☐ Tunai setelah pekerjaan selesai</li>
            <li>☐ Transfer ke rekening [Bank], No rekening : [No Rek]</li>
            </ul>
        </li>
        <li>Jika terjadi keterlambatan pembayaran lebih dari <strong id="maxLate">[jumlah hari]</strong> hari, maka dikenakan denda sebesar <strong id="nominalDenda">Rp [jumlah denda]</strong> per hari keterlambatan.</li>
        </ol>

        <div class="pasal">PASAL 4 - KEWAJIBAN & TANGGUNG JAWAB</div>
        <ol class="indent">
        <li><strong>PIHAK PERTAMA</strong> wajib menyelesaikan pekerjaan sesuai kesepakatan.</li>
        <li><strong>PIHAK KEDUA</strong> wajib menyediakan akses dan dukungan untuk kelancaran pekerjaan.</li>
        </ol>

        <div class="pasal">PASAL 5 - PENYELESAIAN PERSELISIHAN</div>
        <p class="indent">Perselisihan diselesaikan secara musyawarah. Jika tidak tercapai, akan diselesaikan melalui jalur hukum sesuai hukum yang berlaku di Republik Indonesia.</p>

        <div class="pasal">PASAL 6 - PENUTUP</div>
        <p class="indent">Surat ini ditandatangani kedua pihak tanpa paksaan dari pihak manapun.</p>

        <p style="margin-top:3rem;"><strong id="kota">[Kota]</strong>, <strong id="tglIniTtd">[Tanggal]</strong></p>

        <table style="width:100%;text-align:center;margin-top:3rem;">
            <tr>
                <th>PIHAK PERTAMA</th>
                <th>PIHAK KEDUA</th>
            </tr>
            <tr>
                <td><br><br><br><br>( Kahfi Setiawan )</td>
                <td id="namaTtd">[Nama Penerima Jasa]</td>
            </tr>
        </table>

    </div>

    <div style="text-align:center;margin-top:10rem;">
        <button type="button" id="download-btn" class="btn bg-gradient-green text-white w-100" onclick="downloadHTMLasPDF()">
            <i class="fas fa-print"></i> Cetak
        </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>

    <script>

    function numberToIDR(amount = 0){
        const formattedIDR = new Intl.NumberFormat('id-ID', {
            style: 'currency',
            currency: 'IDR',
            minimumFractionDigits: 0, // Menghilangkan desimal jika tidak ada
            maximumFractionDigits: 0, // Menghilangkan desimal jika tidak ada
        }).format(amount);
        return formattedIDR;
    }
        // Ambil semua parameter dari URL
        const params = new URLSearchParams(window.location.search);

        const param = params.get('param');
        const decodeParam = atob(param);
        const jsonParam = JSON.parse(decodeParam);

        const param2 = params.get('param2');
        const decodeParam2 = atob(param2);
        const jsonParam2 = JSON.parse(decodeParam2);

        console.log(param2, decodeParam2, jsonParam2, jsonParam2.maxlate);

        const now = new Date();
        const tahun = now.getFullYear();
        const bulan = String(now.getMonth() + 1).padStart(2, '0'); // Bulan dimulai dari 0
        const tanggal = String(now.getDate()).padStart(2, '0');
        const jam = String(now.getHours()).padStart(2, '0');
        const menit = String(now.getMinutes()).padStart(2, '0');
        const detik = String(now.getSeconds()).padStart(2, '0');

        const namaHariIndonesia = [
        "Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"
        ];

        const namaBulanIndonesia = [
        "Januari", "Februari", "Maret", "April", "Mei", "Juni",
        "Juli", "Agustus", "September", "Oktober", "November", "Desember"
        ];

        document.getElementById('noSurat').textContent = tahun+bulan+tanggal+jam+menit+detik || 'Tidak ada no surat';
        document.getElementById('hariIni').textContent = namaHariIndonesia[now.getDay()] || '';
        document.getElementById('tglIni').textContent = tanggal+' '+namaBulanIndonesia[now.getMonth()]+' '+tahun || '';
        document.getElementById('kota').textContent = 'Sumedang' || '';
        document.getElementById('tglIniTtd').textContent = tanggal+' '+namaBulanIndonesia[now.getMonth()]+' '+tahun || '';
        document.getElementById('namaTtd').innerHTML = '<br><br><br><br>( '+jsonParam.name+' )' || 'Tidak ada nama';
        
        // // Tampilkan ke dalam elemen HTML
        document.getElementById('nama').textContent = jsonParam.name || 'Tidak ada nama';
        document.getElementById('alamat').textContent = jsonParam.alamat || 'Tidak ada alamat';
        document.getElementById('ktp').textContent = jsonParam.ktp || 'Tidak ada ktp';
        document.getElementById('detail').textContent = jsonParam.detail || 'Tidak ada detail';

        const dateStart = jsonParam2.start_date;
        const dayStart = new Date(dateStart);
        const dayStartName = namaHariIndonesia[dayStart.getDay()];
        const dateStartParts = dateStart.split('-');

        const yearStartNumber = parseInt(dateStartParts[0]);
        const monthStartNumber = parseInt(dateStartParts[1]);
        const dateStartNumber = parseInt(dateStartParts[2]);

        const dateEnd = jsonParam2.end_date;
        const dayEnd = new Date(dateEnd);
        const dayEndName = namaHariIndonesia[dayEnd.getDay()];
        const dateEndParts = dateEnd.split('-');

        const yearEndNumber = parseInt(dateEndParts[0]);
        const monthEndNumber = parseInt(dateEndParts[1]);
        const dateEndNumber = parseInt(dateEndParts[2]);


        const angka = jsonParam2.total;
        const persentase = 50;

        const halfTotal = (persentase / 100) * angka;

        document.getElementById('total').textContent = numberToIDR(jsonParam2.total) || 'Tidak ada total';
        document.getElementById('startDate').textContent = dayStartName+', '+ dateStartNumber+' '+namaBulanIndonesia[monthStartNumber]+ ' '+yearStartNumber  || 'Tidak ada start';
        document.getElementById('endDate').textContent = dayEndName+', '+ dateEndNumber+' '+namaBulanIndonesia[monthEndNumber]+ ' '+yearStartNumber  || 'Tidak ada end';
        document.getElementById('maxLate').textContent = jsonParam2.maxlate || 'Tidak ada max late';
        document.getElementById('nominalDenda').textContent = 'Rp '+jsonParam2.denda || 'Tidak ada denda';
        document.getElementById('halfTotal').textContent = numberToIDR(halfTotal) || 'Tidak ada total';

        function downloadHTMLasPDF() {
            // const element = document.body; // Atau elemen HTML spesifik yang ingin Anda konversi
            const element = document.getElementById('cetakIni');

            const namaFileDasar = 'surat_perjanjian_';

            // Membuat nama file dengan format namafile_YYYYMMDD_HHMMSS
            const namaFileLengkap = `${namaFileDasar}_${tahun}${bulan}${tanggal}_${jam}${menit}${detik}.pdf`;

            const opt = {
                margin:      10, // Atur margin di semua sisi (dalam mm)
                filename:    namaFileLengkap,
                image:       { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF:       { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            // Tambahkan padding melalui CSS langsung ke elemen yang akan diunduh
            element.style.padding = '10px'; // Contoh padding 20px di semua sisi

            // Generate dan download PDF
            html2pdf().from(element).set(opt).save();

            // Hapus kembali padding setelah selesai (opsional)
            setTimeout(() => {
                element.style.padding = '';
            }, 100);
        }

        
    </script>

</body>
</html>
